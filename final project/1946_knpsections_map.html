<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kruger National Park Poaching per Ranger Section</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
    #map { width: 100%; height: 780px; }
    .custom-popup .leaflet-popup-content { 
        font-size: 16px; /* Adjust font size as needed */
    }
</style>
    </style>
</head>
<body>
    <h1>Kruger National Park: Distribution of Poaching Across Ranger Sections in 1946</h1>
    <div id="map"></div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src = "1946_knpsections_poach.js"></script> 

    <script>
       var map = L.map('map').setView([-23.988, 31.554], 7.5);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);
    

        var markers = {};

        function updateMap(year) {
    // Iterate over each feature in the sections' data
    sections.features.forEach(function(feature) {
        const incidentsData = feature.properties.PoachingData.find(data => data.Year === year);

        // Skip this iteration if there's no data for the given year
        if (!incidentsData) return;

        const lat = feature.properties.name_sections_Lat;
        const lng = feature.properties.name_sections_Long;
        const name = feature.properties.Name;
        const incidents = incidentsData.Incidents;
        const quote = feature.properties.RangerQuote || "No quote available."; // Provide a fallback if no quote is available
        const rangerName = feature.properties.RangerName || "Unknown Ranger"; // Provide a fallback if no ranger name is provided

        const baseSize = 5;
        
        const markerSize = baseSize + (incidents);

        // Create a circle marker for each section, setting its options and binding a popup with detailed info
        markers[name] = L.circleMarker([lat, lng], {
                    radius: markerSize,
                    fillColor: "#ff7800",
                    color: "#000",
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(map).bindPopup(`<h3>Section: ${name}</h3>
                                         <p>Ranger: ${rangerName}</p>
                                         <p>Quote: "${quote}"</p>`, {
                                             className: 'custom-popup'
                                         });
            });
        }
        
        updateMap(1946); 
    </script>
</body>
</html>