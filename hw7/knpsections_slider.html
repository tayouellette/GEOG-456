<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kruger National Park Poaching per Ranger Section</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <style>
        #map { width: 100%; height: 780px; }
        #slider { width: 100%; margin: 20px 0; }
        .slider-label { text-align: center; }
    </style>
</head>
<body>
    <h1>Kruger National Park: Distribution of Rhino Poaching Across Ranger Sections</h1>
    <div id="map"></div>
    <div class="slider-label"><span id="year-label">Annual Rhino Poaching Across Ranger Sections</span></div>
    <!-- Slider for selecting the year -->
    <div style="text-align: center;">
    <input id="yearSlider" type="range" min="2013" max="2022" value="2013" oninput="updateMap(this.value)" />
    <p>Year: <span id="yearDisplay">2013</span></p>
    </div>
    <!-- Container for the poaching link -->
    <div id="poachingLink" style="position: fixed; bottom: 20px; left: 20px; background: rgba(255, 255, 255, 0.8); padding: 10px; border-radius: 5px;">
    <a href="https://www.poachingfacts.com/poaching-statistics/rhino-poaching-statistics/#"><h3>Rhino Poaching Statistics</h3></a>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="knpsections.js"></script>
    <script>
        var map = L.map('map').setView([-23.988, 31.554], 7.5);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: 'Â© OpenStreetMap contributors'
        }).addTo(map);
    
        // Initialize markers object to keep track of the markers
        var markers = {};
    
        // Function to update the map based on the selected year
function updateMap(selectedYear) {
    document.getElementById('yearDisplay').innerText = selectedYear; // Update the displayed year

    sections.features.forEach(function(feature) {
        var incidentsData = feature.properties.PoachingData.find(function(data) {
            return data.Year == selectedYear;
        });

        var lat = feature.properties.name_sections_Lat;
        var lng = feature.properties.name_sections_Long;
        var name = feature.properties.Name;

        if (markers[name]) {
            map.removeLayer(markers[name]); // Remove existing marker
        }

        var baseSize = 5; // Base size of the marker
        var scalingFactor = 0.5; // Adjust this to change how much the incident count affects the size
        var markerSize = baseSize + (incidentsData ? incidentsData.Incidents * scalingFactor : 0);
        
        markers[name] = L.circleMarker([lat, lng], {
            radius: markerSize,
            fillColor: "#ff7800",
            color: "#000",
            weight: 1,
            opacity: 1,
            fillOpacity: 0.8
        }).addTo(map)
        .bindPopup("<h3>Section: " + name + "</h3><p>Year: " + selectedYear + "<br>Incidents: " + (incidentsData ? incidentsData.Incidents : "0") + "</p>");
    });
}
   
        // Initialize the map with the first year
        updateMap(2013);
    </script>
</body>
</html>
